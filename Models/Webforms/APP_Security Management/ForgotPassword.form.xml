/*
Copyright (c) CLMS. All rights reserved.
Licensed under the AGPL-3.0 license. See LICENSE file in the project root for full license information.*/

{"Actions":[{"Code":"function void Render()\r\n{\n\tModel.Title = null;\n}","Name":"Render","Permissions":[],"AllowAnonymous":true,"AllowAllAuthenticatedUsers":false,"AccessLog":false,"IsEntryPoint":true,"CausesValidation":false},{"Code":"function void ResetPassword()\r\n{\r\n\tvar user = Domain.ApplicationUser.Find(u => u.Email == Model.txtEmail).First();\r\n\r\n\tif (user == null)\r\n\t{\r\n\t    ShowMessage(LocalResources.RES_CUSTOM_NotFound, AppLib.MessageType.Error);\r\n\t    return;\r\n\t}\r\n\t\r\n\tif (string.IsNullOrWhiteSpace(user.Email) || !RegExpLib.VerbalExpressions.IsEmail(user.Email))\r\n\t{\r\n\t    ShowMessage(LocalResources.RES_CUSTOM_NoMail, AppLib.MessageType.Error);\r\n\t    return;\r\n\t}\r\n\t\r\n\tvar code = AppLib.Security.GeneratePasswordResetToken(user);\r\n\tvar link = FormModels.ResetPassword.Controller.Render.GetLink(code);\r\n\tCommonLib.EmailMessage emailMessage;\r\n\temailMessage.To = { user.Email };\r\n\temailMessage.Subject = \"Password Reset\";\r\n\temailMessage.Body = \"Please click <a href='\" + link + \"'>here</a> to reset your password\";\r\n\temailMessage.IsBodyHtml = true;\r\n\tCommonLib.Utilities.SendEmailAsync(emailMessage);\r\n\t\r\n\tCloseForm();\r\n}","Name":"ResetPassword","Permissions":[],"AllowAnonymous":true,"AllowAllAuthenticatedUsers":false,"AccessLog":false,"IsEntryPoint":false,"CausesValidation":false}],"EventListeners":[],"Resources":[{"Type":"S","Key":"RES_PAGETITLE_Render","Languages":[{"Name":"en-us","Value":"Reset Password"},{"Name":"el","Value":""}]},{"Type":"S","Key":"RES_PAGETITLE_ResetPassword","Languages":[{"Name":"en-us","Value":"Reset Password"},{"Name":"el","Value":""}]},{"Type":"S","Key":"RES_LABEL_Label1","Languages":[{"Name":"en-us","Value":"Reset Password"},{"Name":"el","Value":""}]},{"Type":"S","Key":"RES_LABEL_Label4","Languages":[{"Name":"en-us","Value":"Email:"},{"Name":"el","Value":""}]},{"Type":"S","Key":"RES_LABEL_Label51","Languages":[{"Name":"en-us","Value":"Cancel"},{"Name":"el","Value":""}]},{"Type":"S","Key":"RES_LABEL_Label6","Languages":[{"Name":"en-us","Value":"Reset"},{"Name":"el","Value":""}]},{"Type":"S","Key":"RES_DATAVALIDATION_MESSAGE_UsernameIsEmpty","Languages":[{"Name":"en-us","Value":"Username Is Empty"},{"Name":"el","Value":""}]},{"Type":"C","Key":"RES_CUSTOM_NoMail","Languages":[{"Name":"en-us","Value":"No valid email address was found for this user. Please contact the Administrator of the application."},{"Name":"el","Value":""}]},{"Type":"C","Key":"RES_CUSTOM_NotFound","Languages":[{"Name":"en-us","Value":"No user found with the provided username."},{"Name":"el","Value":""}]},{"Type":"S","Key":"RES_TOOLTIP_Body","Languages":[{"Name":"en-us"}]},{"Type":"S","Key":"RES_TOOLTIP_Table","Languages":[{"Name":"en-us"}]},{"Type":"S","Key":"RES_TOOLTIP_RowControl","Languages":[{"Name":"en-us"}]},{"Type":"S","Key":"RES_TOOLTIP_CellControl","Languages":[{"Name":"en-us"}]},{"Type":"S","Key":"RES_TOOLTIP_FieldSet","Languages":[{"Name":"en-us","Value":""}]},{"Type":"S","Key":"RES_TOOLTIP_FieldSetHeader","Languages":[{"Name":"en-us","Value":""}]},{"Type":"S","Key":"RES_LABEL_Label61","Languages":[{"Name":"en-us","Value":""}]},{"Type":"S","Key":"RES_TOOLTIP_Label61","Languages":[{"Name":"en-us"}]},{"Type":"S","Key":"RES_TOOLTIP_Label1","Languages":[{"Name":"en-us","Value":""}]},{"Type":"S","Key":"RES_TOOLTIP_FieldSetContainer","Languages":[{"Name":"en-us","Value":""}]},{"Type":"S","Key":"RES_TOOLTIP_Table1","Languages":[{"Name":"en-us","Value":""}]},{"Type":"S","Key":"RES_TOOLTIP_Row2","Languages":[{"Name":"en-us","Value":""}]},{"Type":"S","Key":"RES_TOOLTIP_Cell4","Languages":[{"Name":"en-us","Value":""}]},{"Type":"S","Key":"RES_TOOLTIP_Label4","Languages":[{"Name":"en-us","Value":""}]},{"Type":"S","Key":"RES_TOOLTIP_Cell5","Languages":[{"Name":"en-us","Value":""}]},{"Type":"S","Key":"RES_PLACEHOLDER_txtUsername","Languages":[{"Name":"en-us"}]},{"Type":"S","Key":"RES_CONTROL_txtUsername_RequiredMessage","Languages":[{"Name":"en-us","Value":""}]},{"Type":"S","Key":"RES_TOOLTIP_txtUsername","Languages":[{"Name":"en-us","Value":""}]},{"Type":"S","Key":"RES_TOOLTIP_FieldSetFooter","Languages":[{"Name":"en-us","Value":""}]},{"Type":"S","Key":"RES_TOOLTIP_Label6","Languages":[{"Name":"en-us","Value":""}]},{"Type":"S","Key":"RES_TOOLTIP_Label51","Languages":[{"Name":"en-us","Value":""}]}],"ViewModel":[{"Type":0,"Name":"txtEmail","Datatype":"string","Children":[],"IsRequired":false,"Hidden":false,"Readonly":false,"Precision":0,"Scale":0,"IsCollection":false,"IsPk":false}],"DataSets":[],"ConditionalFormattings":[],"DataValidations":[{"Name":"UsernameIsEmpty","Context":"FormRoot","Condiiton":"function bool OnDatavalidation()\r\n{\r\n  return string.IsNullOrWhiteSpace(Model.txtEmail);\r\n}","OnEvent":"4","Message":"LocalResources.RES_DATAVALIDATION_MESSAGE_UsernameIsEmpty","MessageType":0,"RelatedControls":["txtUsername","Cell5"],"ValidationGroupName":""}],"CalculatedExpressions":[],"Controls":[{"$type":"CLMS.AppDev.DomainModel.Models.BodyControl, CLMS.AppDev.DomainModel","Name":"Body","CssStyle":"","CssClass":"","DoesNotMakeFormDirty":false,"FontSizeRole":0,"ElementSizeRole":0,"ColorRole":0,"FilterOperator":0,"RowOperator":0,"Ovewrite":false,"ApplyOnBlur":false,"HiddenInMobileView":false,"Controls":[{"$type":"CLMS.AppDev.DomainModel.Models.TableControl, CLMS.AppDev.DomainModel","IsResponsive":false,"IsGrid":false,"IsDataSourceGrid":false,"ResponsiveThreshold":0,"PageSize":10,"PagerPosition":1,"IncludePaging":true,"AddRowPermmited":true,"DeleteRowPermmited":false,"DeleteMultiRowPermmited":false,"ShowWarningPermmited":false,"ShowMultiWarningPermmited":false,"IncludeAlternateRowsStyle":false,"IncludeNumbering":false,"FilteringType":0,"HeadRows":[],"BodyRows":[{"Cells":[{"ColSpan":1,"RowSpan":1,"Name":"CellControl","CssStyle":"","CssClass":"","DoesNotMakeFormDirty":false,"FontSizeRole":0,"ElementSizeRole":0,"ColorRole":0,"FilterOperator":7,"RowOperator":1,"Ovewrite":true,"ApplyOnBlur":true,"HiddenInMobileView":false,"Controls":[{"$type":"CLMS.AppDev.DomainModel.Models.FieldSetControl, CLMS.AppDev.DomainModel","Header":{"Name":"FieldSetHeader","CssStyle":"","CssClass":"","Tooltip":"","Datasource":"","DoesNotMakeFormDirty":false,"FontSizeRole":0,"ElementSizeRole":0,"ColorRole":0,"FilterOperator":0,"RowOperator":0,"Ovewrite":false,"ApplyOnBlur":false,"HiddenInMobileView":false,"Controls":[{"$type":"CLMS.AppDev.DomainModel.Models.LabelControl, CLMS.AppDev.DomainModel","Value":"","RenderAsHtml":false,"Name":"Label61","CssStyle":"top: -2px;","CssClass":"glyphicon round-icon glyphicon-refresh","DoesNotMakeFormDirty":false,"FontSizeRole":0,"ElementSizeRole":0,"ColorRole":0,"FilterOperator":7,"RowOperator":1,"Ovewrite":true,"ApplyOnBlur":true,"HiddenInMobileView":false,"Controls":[]},{"$type":"CLMS.AppDev.DomainModel.Models.LabelControl, CLMS.AppDev.DomainModel","Value":"Reset Password","FormatString":"","RenderAsHtml":false,"Name":"Label1","CssStyle":"","CssClass":"","Tooltip":"","Datasource":"","DoesNotMakeFormDirty":false,"FontSizeRole":5,"ElementSizeRole":0,"ColorRole":0,"FilterOperator":0,"RowOperator":0,"Ovewrite":false,"ApplyOnBlur":false,"HiddenInMobileView":false,"Controls":[]}]},"Container":{"Name":"FieldSetContainer","CssStyle":"","CssClass":"","Tooltip":"","Datasource":"","DoesNotMakeFormDirty":false,"FontSizeRole":0,"ElementSizeRole":0,"ColorRole":0,"FilterOperator":0,"RowOperator":0,"Ovewrite":false,"ApplyOnBlur":false,"HiddenInMobileView":false,"Controls":[{"$type":"CLMS.AppDev.DomainModel.Models.TableControl, CLMS.AppDev.DomainModel","IsResponsive":true,"IsGrid":false,"IsDataSourceGrid":false,"ResponsiveThreshold":0,"PageSize":10,"PagerPosition":0,"IncludePaging":false,"AddRowPermmited":false,"DeleteRowPermmited":false,"DeleteMultiRowPermmited":false,"ShowWarningPermmited":false,"ShowMultiWarningPermmited":false,"Sorting":"","IncludeAlternateRowsStyle":false,"IncludeNumbering":false,"Filtering":"","FilteringType":0,"WarningMessage":"","MultiWarningMessage":"","HeadRows":[],"BodyRows":[{"Cells":[{"ColSpan":4,"RowSpan":0,"Name":"Cell4","CssStyle":"","CssClass":"","Tooltip":"","Datasource":"","DoesNotMakeFormDirty":false,"FontSizeRole":0,"ElementSizeRole":0,"ColorRole":0,"FilterOperator":0,"RowOperator":0,"Ovewrite":false,"ApplyOnBlur":false,"HiddenInMobileView":false,"Controls":[{"$type":"CLMS.AppDev.DomainModel.Models.LabelControl, CLMS.AppDev.DomainModel","Value":"Email:","FormatString":"","RenderAsHtml":false,"Name":"Label4","CssStyle":"font-size:14px;\n","CssClass":"","Tooltip":"","Datasource":"","DoesNotMakeFormDirty":false,"FontSizeRole":0,"ElementSizeRole":0,"ColorRole":0,"FilterOperator":0,"RowOperator":0,"Ovewrite":false,"ApplyOnBlur":false,"HiddenInMobileView":false,"Controls":[]}]},{"ColSpan":8,"RowSpan":0,"Name":"Cell5","CssStyle":"","CssClass":"","Tooltip":"","Datasource":"","DoesNotMakeFormDirty":false,"FontSizeRole":0,"ElementSizeRole":0,"ColorRole":0,"FilterOperator":0,"RowOperator":0,"Ovewrite":false,"ApplyOnBlur":false,"HiddenInMobileView":false,"Controls":[{"$type":"CLMS.AppDev.DomainModel.Models.TextBoxControl, CLMS.AppDev.DomainModel","ReadOnly":false,"Required":true,"MaskString":"","Name":"txtUsername","CssStyle":"","CssClass":"","Tooltip":"","Datasource":"txtEmail","DoesNotMakeFormDirty":true,"FontSizeRole":0,"ElementSizeRole":0,"ColorRole":0,"FilterOperator":0,"RowOperator":0,"Ovewrite":false,"ApplyOnBlur":false,"HiddenInMobileView":false,"Controls":[]}]}],"Name":"Row2","CssStyle":"","CssClass":"","Tooltip":"","Datasource":"","DoesNotMakeFormDirty":false,"FontSizeRole":0,"ElementSizeRole":0,"ColorRole":0,"FilterOperator":0,"RowOperator":0,"Ovewrite":false,"ApplyOnBlur":false,"HiddenInMobileView":false}],"FooterRows":[],"TableCols":[],"DataSetInputs":[],"Name":"Table1","CssStyle":"","CssClass":"","Tooltip":"","Datasource":"","DoesNotMakeFormDirty":false,"FontSizeRole":0,"ElementSizeRole":0,"ColorRole":0,"FilterOperator":0,"RowOperator":0,"Ovewrite":false,"ApplyOnBlur":false,"HiddenInMobileView":false}]},"Footer":{"Name":"FieldSetFooter","CssStyle":"","CssClass":"","Tooltip":"","Datasource":"","DoesNotMakeFormDirty":false,"FontSizeRole":0,"ElementSizeRole":0,"ColorRole":0,"FilterOperator":0,"RowOperator":0,"Ovewrite":false,"ApplyOnBlur":false,"HiddenInMobileView":false,"Controls":[{"$type":"CLMS.AppDev.DomainModel.Models.ButtonControl, CLMS.AppDev.DomainModel","ActionType":3,"AppliesFiltersOfList":"","ClearsFiltersOfList":"","ValidationGroups":[],"ShowConfirmation":false,"IsDefaultButton":true,"IsEscapeButton":false,"ImageUrl":"","Type":0,"ControllerAction":{"Type":2,"Action":"ResetPassword","Controller":"this","ControllerType":0,"OnUnauthorized":"HIDE","TargetFrame":"_self","ModalSize":"","Parameters":[],"OnCloseModalDialogAction":"","Permissions":[],"IsPublic":false,"NoPermissionsRequired":false,"AllowAnonymous":false,"AllowAllAuthenticatedUsers":false,"EnableAccessLog":false},"Labels":[{"$type":"CLMS.AppDev.DomainModel.Models.LabelControl, CLMS.AppDev.DomainModel","Value":"Reset","FormatString":"","RenderAsHtml":false,"Name":"Label6","CssStyle":"","CssClass":"","Tooltip":"","Datasource":"","DoesNotMakeFormDirty":false,"FontSizeRole":0,"ElementSizeRole":0,"ColorRole":0,"FilterOperator":0,"RowOperator":0,"Ovewrite":false,"ApplyOnBlur":false,"HiddenInMobileView":false,"Controls":[]}],"Name":"btnChangePassword","CssStyle":"","CssClass":"","Tooltip":"","Datasource":"","DoesNotMakeFormDirty":false,"FontSizeRole":0,"ElementSizeRole":3,"ColorRole":5,"FilterOperator":0,"RowOperator":0,"Ovewrite":false,"ApplyOnBlur":false,"HiddenInMobileView":false,"OnClick":{"Type":2,"Action":"ResetPassword","Controller":"this","ControllerType":0,"OnUnauthorized":"HIDE","TargetFrame":"_self","ModalSize":"","Parameters":[],"OnCloseModalDialogAction":"","Permissions":[],"IsPublic":false,"NoPermissionsRequired":false,"AllowAnonymous":false,"AllowAllAuthenticatedUsers":false,"EnableAccessLog":false}},{"$type":"CLMS.AppDev.DomainModel.Models.ButtonControl, CLMS.AppDev.DomainModel","ActionType":1,"AppliesFiltersOfList":"","ClearsFiltersOfList":"","ValidationGroups":[],"ShowConfirmation":false,"IsDefaultButton":false,"IsEscapeButton":true,"ImageUrl":"","Type":0,"Labels":[{"$type":"CLMS.AppDev.DomainModel.Models.LabelControl, CLMS.AppDev.DomainModel","Value":"Cancel","FormatString":"","RenderAsHtml":false,"Name":"Label51","CssStyle":"","CssClass":"","Tooltip":"","Datasource":"","DoesNotMakeFormDirty":false,"FontSizeRole":0,"ElementSizeRole":0,"ColorRole":0,"FilterOperator":0,"RowOperator":0,"Ovewrite":false,"ApplyOnBlur":false,"HiddenInMobileView":false,"Controls":[]}],"Name":"Button11","CssStyle":"","CssClass":"pull-right","Tooltip":"","Datasource":"","DoesNotMakeFormDirty":false,"FontSizeRole":0,"ElementSizeRole":3,"ColorRole":1,"FilterOperator":0,"RowOperator":0,"Ovewrite":false,"ApplyOnBlur":false,"HiddenInMobileView":false,"OnClick":{"Type":1,"ControllerType":0,"OnUnauthorized":"HIDE","TargetFrame":"_self","ModalSize":"POPUP","Parameters":[],"Permissions":[],"IsPublic":false,"NoPermissionsRequired":false,"AllowAnonymous":false,"AllowAllAuthenticatedUsers":false,"EnableAccessLog":false}}]},"HasHeader":true,"HasFooter":true,"Collapsible":false,"IsCollapsed":false,"Name":"FieldSet","CssStyle":"margin: 0px auto;\nmax-width: 500px;","CssClass":"","Tooltip":"","Datasource":"","DoesNotMakeFormDirty":false,"FontSizeRole":0,"ElementSizeRole":0,"ColorRole":0,"FilterOperator":0,"RowOperator":0,"Ovewrite":false,"ApplyOnBlur":false,"HiddenInMobileView":false}]}],"Name":"RowControl","CssStyle":"","CssClass":"","DoesNotMakeFormDirty":false,"FontSizeRole":0,"ElementSizeRole":0,"ColorRole":0,"FilterOperator":7,"RowOperator":1,"Ovewrite":true,"ApplyOnBlur":true,"HiddenInMobileView":false}],"FooterRows":[],"TableCols":[],"DataSetInputs":[],"Name":"Table","CssStyle":"width: 100%;\nheight: 70%;\nvertical-align: middle;","CssClass":"","DoesNotMakeFormDirty":false,"FontSizeRole":0,"ElementSizeRole":0,"ColorRole":0,"FilterOperator":7,"RowOperator":1,"Ovewrite":true,"ApplyOnBlur":true,"HiddenInMobileView":false}]}],"ShowWarningWhenLeavingPage":false,"IsMasterPage":false,"IsPartial":false,"MasterPage":"MasterPage","Imports":[],"MaxViewModelLevel":0,"ModelName":"ForgotPassword","Version":"0.3.6"}