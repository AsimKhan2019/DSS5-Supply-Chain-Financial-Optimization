
// Copyright (c) CLMS. All rights reserved.
// Licensed under the AGPL-3.0 license. See LICENSE file in the project root for full license information.
// This source file was autogenerated by zAppDev(r).

using System;
using System.Runtime.Serialization;
using System.Collections.Generic;
using System.ComponentModel;
using System.Linq;
using System.Reflection;
using System.Collections;
using zAppDev.DotNet.Framework.Utilities;
using zAppDev.DotNet.Framework.Configuration;
using zAppDev.DotNet.Framework.Data.Domain;

using DSS5_SupplyChainFinancialsOptimisation.DAL;

namespace DSS5_SupplyChainFinancialsOptimisation.BO
{
	/// <summary>
	/// The MapPoint extensions
	/// </summary>
	public static class MapPointExtensions
	{
        public static System.Collections.Generic.List<DSS5_SupplyChainFinancialsOptimisation.BO.MapPoint> InitiOrderMapPoints(DSS5_SupplyChainFinancialsOptimisation.BO.Order order){using (new zAppDev.DotNet.Framework.Profiling.Profiler("MapPoint", zAppDev.DotNet.Framework.Profiling.AppDevSymbolType.ClassOperation, "InitiOrderMapPoints")) {
System.Collections.Generic.List<DSS5_SupplyChainFinancialsOptimisation.BO.MapPoint> mapPoints = new System.Collections.Generic.List<DSS5_SupplyChainFinancialsOptimisation.BO.MapPoint>();
DSS5_SupplyChainFinancialsOptimisation.BO.MapPoint fromPoint = new DSS5_SupplyChainFinancialsOptimisation.BO.MapPoint();
if ((((((order?.From ?? "") == null || (order?.From ?? "") == "")) == false))) {
fromPoint?.ConsumeGoogleGeocode((order?.From ?? ""));
}
fromPoint.Address = (order?.From ?? "");fromPoint.Title = "Shipping From";fromPoint.Icon = "http://apps.zappdev.com/TomeFinance_1242_vvasilopoulos/resources/images/" + "industries.png";mapPoints?.Add(fromPoint);
if (((order?.IntermediateParty ?? false))) {
foreach (var bol in order?.BillOfLandings ?? Enumerable.Empty<DSS5_SupplyChainFinancialsOptimisation.BO.BillOfLanding>()) {
if ((bol?.LandingPlace == order?.From)) {
continue;}
DSS5_SupplyChainFinancialsOptimisation.BO.MapPoint intermediaryFromPoint = new DSS5_SupplyChainFinancialsOptimisation.BO.MapPoint();
if ((((((bol?.LandingPlace ?? "") == null || (bol?.LandingPlace ?? "") == "")) == false))) {
intermediaryFromPoint?.ConsumeGoogleGeocode((bol?.LandingPlace ?? ""));
}
intermediaryFromPoint.Address = (bol?.LandingPlace ?? "");intermediaryFromPoint.Icon = "http://apps.zappdev.com/TomeFinance_1242_vvasilopoulos/resources/images/" + "transport.png";intermediaryFromPoint.Title = "Intermediary Landing Place";mapPoints?.Add(intermediaryFromPoint);
if ((bol?.DeliveryPlace == order?.DeliveryTo)) {
continue;}
DSS5_SupplyChainFinancialsOptimisation.BO.MapPoint intemediaryToPoint = new DSS5_SupplyChainFinancialsOptimisation.BO.MapPoint();
if ((((((bol?.DeliveryPlace ?? "") == null || (bol?.DeliveryPlace ?? "") == "")) == false))) {
intemediaryToPoint?.ConsumeGoogleGeocode((bol?.DeliveryPlace ?? ""));
}
intemediaryToPoint.Address = (bol?.DeliveryPlace ?? "");intemediaryToPoint.Icon = "http://apps.zappdev.com/TomeFinance_1242_vvasilopoulos/resources/images/" + "transport.png";intemediaryToPoint.Title = "Intermediary Delivery Place";mapPoints?.Add(intemediaryToPoint);
}
}
DSS5_SupplyChainFinancialsOptimisation.BO.MapPoint deliveryPoint = new DSS5_SupplyChainFinancialsOptimisation.BO.MapPoint();
if ((((((order?.DeliveryTo ?? "") == null || (order?.DeliveryTo ?? "") == "")) == false))) {
deliveryPoint?.ConsumeGoogleGeocode((order?.DeliveryTo ?? ""));
}
deliveryPoint.Address = (order?.DeliveryTo ?? "");deliveryPoint.Title = "Delivery To";deliveryPoint.Icon = "http://apps.zappdev.com/TomeFinance_1242_vvasilopoulos/resources/images/" + "commercial-places.png";mapPoints?.Add(deliveryPoint);
return mapPoints;
}
}


public static void ConsumeGoogleGeocode(this BO.MapPoint @this, string address){using (new zAppDev.DotNet.Framework.Profiling.Profiler("MapPoint", zAppDev.DotNet.Framework.Profiling.AppDevSymbolType.ClassOperation, "ConsumeGoogleGeocode")) {
DSS5_SupplyChainFinancialsOptimisation.ExternalStructs.GoogleGeocode.Root response = new DSS5_SupplyChainFinancialsOptimisation.ExternalStructs.GoogleGeocode.Root();
try {
response = DSS5_SupplyChainFinancialsOptimisation.BLL.ExternalRestServices.GoogleGeocodeRestService.GeoLocation(address);}
catch (System.Exception x) {
zAppDev.DotNet.Framework.Utilities.DebugHelper.Log(zAppDev.DotNet.Framework.Utilities.DebugMessageType.Error, "MapPoint",  DSS5_SupplyChainFinancialsOptimisation.Hubs.EventsHub.RaiseDebugMessage, x);
zAppDev.DotNet.Framework.Utilities.Serializer<DSS5_SupplyChainFinancialsOptimisation.ExternalStructs.GoogleGeocode.Root> ser = new zAppDev.DotNet.Framework.Utilities.Serializer<DSS5_SupplyChainFinancialsOptimisation.ExternalStructs.GoogleGeocode.Root>();
zAppDev.DotNet.Framework.Utilities.DebugHelper.Log(zAppDev.DotNet.Framework.Utilities.DebugMessageType.Error, "MapPoint",  DSS5_SupplyChainFinancialsOptimisation.Hubs.EventsHub.RaiseDebugMessage, "google geocode response " + ser.ToJson(response));
throw x;
}
@this.Latitude = double.Parse(zAppDev.DotNet.Framework.Utilities.Common.GetItemFromArray(response.results, 0).geometry.location.lat, System.Globalization.NumberStyles.Number | System.Globalization.NumberStyles.Float, System.Globalization.CultureInfo.InvariantCulture);@this.Longitude = double.Parse(zAppDev.DotNet.Framework.Utilities.Common.GetItemFromArray(response.results, 0).geometry.location.lng, System.Globalization.NumberStyles.Number | System.Globalization.NumberStyles.Float, System.Globalization.CultureInfo.InvariantCulture);}
}



        
	}
}
